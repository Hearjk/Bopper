<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bopper - Beat-Synced GIF Player</title>
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="app.css">
</head>
<body>
    <div class="background-grid"></div>

    <main id="mainContent">
        <header>
            <h1 class="logo">BOPPER</h1>
            <span class="badge">WEB</span>
        </header>

        <!-- GIF Display - Clickable for upload -->
        <div class="gif-container">
            <div class="gif-frame" id="gifFrame" onclick="triggerUpload()" ondragover="handleDragOver(event)" ondrop="handleDrop(event)">
                <button class="clear-gif-btn" id="clearGifBtn" onclick="clearGIF(event)">&times;</button>
                <canvas id="gifCanvas"></canvas>
                <img id="gifDisplay" src="" alt="GIF Preview">
                <div class="placeholder" id="placeholder">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="17 8 12 3 7 8"/>
                        <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                    <span>Drag or click to upload</span>
                    <span class="placeholder-hint">GIF, image, or video</span>
                </div>
            </div>
        </div>

        <!-- BPM Display -->
        <div class="bpm-display">
            <span class="bpm-value" id="bpmValue">120</span>
            <span class="bpm-label">BPM</span>
        </div>

        <!-- BPM Controls -->
        <div class="bpm-controls">
            <div class="control-group">
                <label>Set BPM</label>
                <div class="input-row">
                    <button class="adjust-btn" onclick="adjustBPM(-1)">-</button>
                    <input type="number" id="bpmInput" value="120" min="20" max="300" onchange="setBPM(this.value)">
                    <button class="adjust-btn" onclick="adjustBPM(1)">+</button>
                </div>
            </div>

            <div class="control-group">
                <label>Tap Tempo</label>
                <button class="tap-btn" id="tapBtn" onclick="tapTempo()">
                    TAP
                </button>
            </div>

            <div class="control-group">
                <label>Mic Detection</label>
                <button class="mic-btn" id="micBtn" onclick="toggleMic()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                        <line x1="12" y1="19" x2="12" y2="23"/>
                        <line x1="8" y1="23" x2="16" y2="23"/>
                    </svg>
                    <span id="micStatus">Start</span>
                </button>
            </div>
        </div>

        <!-- Effects Controls -->
        <div class="effects-controls">
            <button class="effect-btn" id="pulseBtn" onclick="toggleEffect('pulse')">PULSE</button>
            <button class="effect-btn" id="shakeBtn" onclick="toggleEffect('shake')">SHAKE</button>
            <button class="effect-btn" id="theaterBtn" onclick="enterTheaterMode()">THEATER</button>
            <select id="filterSelect" onchange="setFilter(this.value)">
                <option value="none">No Filter</option>
                <option value="invert">Invert</option>
                <option value="sepia">Sepia</option>
                <option value="cyber">Cyber</option>
                <option value="vapor">Vaporwave</option>
                <option value="matrix">Matrix</option>
            </select>
        </div>

        <!-- Playback Controls -->
        <div class="playback-controls">
            <button class="play-btn" id="playBtn" onclick="togglePlayback()">
                <svg id="playIcon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <polygon points="5,3 19,12 5,21"/>
                </svg>
                <svg id="pauseIcon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" style="display:none">
                    <rect x="6" y="4" width="4" height="16"/>
                    <rect x="14" y="4" width="4" height="16"/>
                </svg>
            </button>
            <div class="speed-control">
                <label>Speed</label>
                <select id="speedSelect" onchange="setSpeed(this.value)">
                    <option value="1">Normal</option>
                    <option value="2">1/2</option>
                    <option value="4">1/4</option>
                    <option value="8">1/8</option>
                </select>
            </div>
        </div>

        <!-- Preset GIFs -->
        <div class="upload-section">
            <input type="file" id="gifInput" accept="image/gif,image/png,image/jpeg,image/webp,video/mp4,video/webm,video/quicktime" onchange="handleFileUpload(this.files[0])" hidden>
            <video id="videoSource" style="display:none" muted playsinline></video>
            <div class="preset-gifs">
                <span class="preset-label">Try a preset:</span>
                <button class="preset-btn" onclick="loadPresetGIF('spongebob')">SpongeBob</button>
                <button class="preset-btn" onclick="loadPresetGIF('band')">Band</button>
                <button class="preset-btn" onclick="loadPresetGIF('gandalf')">Gandalf</button>
            </div>
        </div>

        <!-- DAW Plugin Link -->
        <div class="daw-link-section">
            <a href="daw.html" class="daw-link-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                </svg>
                <span>Get the DAW Plugin for macOS</span>
            </a>
        </div>

        <footer>
            <p>Bopper - Beat-synced GIF animation</p>
        </footer>
    </main>

    <!-- Theater Mode Overlay -->
    <div id="theaterMode" class="theater-mode">
        <div class="theater-gif-container">
            <canvas id="theaterCanvas"></canvas>
            <img id="theaterGif" src="" alt="">
        </div>
        <div class="theater-exit-banner" onclick="exitTheaterMode()">
            <span>Click here or press ESC to exit Theater Mode</span>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
